{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/editor.ts","src/elements/bg-editable.ts","src/elements/block.ts","src/elements/editable.ts","src/elements/file-upload.ts","src/elements/image.ts","src/elements/line.ts","src/elements/text.ts"],"names":[],"mappings":"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","file":"static-edit.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import {Block} from './elements/block'\nimport {Line} from './elements/line'\nimport {Image} from './elements/image'\nimport {Editable} from './elements/editable'\nimport {BgEditable} from \"./elements/bg-editable\";\n\nexport type Options = {\n    saveButton: boolean,\n    selector: string,\n    bgSelector: string,\n}\n\nexport class Editor {\n    private editing: boolean\n    private elems: Editable[]\n    private selector: string = '.editable'\n    private bgSelector: string = '.bg-editable'\n\n    constructor(private options: Options) {\n        this.handleOptions()\n\n        this.elems = []\n\n        let elems: Array<Element> = Array.from(document.querySelectorAll(this.selector))\n        elems = elems.concat(Array.from(document.querySelectorAll(this.bgSelector)))\n\n        for (let i = 0; i < elems.length; ++i) {\n            let elm: Editable\n            let htmlElement: HTMLElement = <HTMLElement>elems[i];\n\n            if (htmlElement.matches(this.bgSelector)) {\n                elm = new BgEditable(htmlElement, this)\n            } else if (elems[i].tagName === 'P') {\n                elm = new Block(htmlElement, this)\n            } else if (elems[i].tagName === 'IMG') {\n                elm = new Image(htmlElement, this)\n            } else {\n                elm = new Line(htmlElement, this)\n            }\n\n            elm.bindEvents()\n            this.elems.push(elm)\n        }\n    }\n\n    handleOptions() {\n        if (this.options.saveButton === true) {\n            this.createSaveButton()\n        }\n\n        if (this.options.selector !== undefined) {\n            this.selector = this.options.selector\n        }\n    }\n\n    editionStarted(elem: HTMLElement, oldValue: string) {\n        if (this.editing) {\n            return false\n        }\n\n        this.editing = true\n\n        window.dispatchEvent(new CustomEvent('static_edit.editing', {detail: {elem, oldValue}}))\n\n        return true\n    }\n\n    editionEnded(elem: HTMLElement, oldValue: string, newValue: string) {\n        this.editing = false\n\n        window.dispatchEvent(new CustomEvent('static_edit.edited', {detail: {elem, oldValue, newValue}}))\n    }\n\n    private createSaveButton() {\n        const button = document.createElement('button')\n        button.addEventListener('click', (e) => {\n            e.preventDefault()\n            e.stopPropagation()\n\n            window.dispatchEvent(\n                new CustomEvent('static_edit.saving', {detail: {changed: this.elems.filter((e) => e.hasChanged)}})\n            )\n        })\n\n        button.textContent = 'Save'\n        button.style.position = 'absolute'\n        button.style.top = '20px'\n        button.style.left = '20px'\n        document.body.appendChild(button)\n    }\n}\n","import {FileUpload} from \"./file-upload\";\n\nexport class BgEditable extends FileUpload {\n\n    get value(): string {\n        return this.elem.style.backgroundImage\n    }\n\n    protected changeValue(value, name): void {\n        this.elem.dataset.fileName = name\n        this.elem.style.backgroundImage = `url(${value})`\n    }\n}","import {Text} from \"./text\";\n\nexport class Block extends Text {\n    createField(): HTMLInputElement {\n        return <any>document.createElement('textarea')\n    }\n}\n","import {Editor} from '../editor'\n\nexport abstract class Editable {\n    protected elem: HTMLElement\n    protected editor: Editor\n    protected changed: boolean\n\n    constructor(elem: HTMLElement, editor: Editor) {\n        this.elem = elem\n        this.editor = editor\n    }\n\n    get element(): HTMLElement {\n        return this.elem\n    }\n\n    get hasChanged(): boolean {\n        return this.changed\n    }\n\n    abstract get value(): string\n\n    abstract createField(): HTMLInputElement\n\n    abstract bindEvents(): void\n}\n","import {Editable} from \"./editable\"\n\ninterface FileReaderEventTarget extends EventTarget {\n    result: string\n}\n\nexport abstract class FileUpload extends Editable {\n    createField(): HTMLInputElement {\n        const input = document.createElement('input')\n\n        input.type = 'file'\n        input.style.display = 'none'\n\n        return input\n    }\n\n    bindEvents() {\n        this.elem.addEventListener('click', (e) => {\n            e.stopPropagation()\n            e.preventDefault()\n\n            const file = this.createField()\n            file.addEventListener('change', () => {\n                const uploadedFile = file.files[0]\n                if (!!uploadedFile.type.match(/image.*/)) {\n                    const reader = new FileReader()\n                    reader.addEventListener('loadend', (e: ProgressEvent) => {\n                        const newValue = (<FileReaderEventTarget>e.target).result\n                        const oldValue = this.value\n\n                        this.changeValue(newValue, uploadedFile.name)\n                        this.changed = true\n\n                        this.elem.parentNode.removeChild(file)\n\n                        setTimeout(() => this.editor.editionEnded(this.elem, oldValue, newValue), 100)\n                    })\n\n                    reader.readAsDataURL(uploadedFile)\n                }\n            })\n\n            this.elem.parentNode.appendChild(file)\n            file.click()\n        })\n    }\n\n    protected abstract changeValue(value, name): void\n}\n","import {FileUpload} from \"./file-upload\";\n\nexport class Image extends FileUpload {\n    elem: HTMLImageElement\n\n    get value(): string {\n        return this.elem.src\n    }\n\n    changeValue(value, name): void {\n        this.elem.src = value\n        this.elem.dataset.fileName = name\n    }\n}\n","import {Text} from \"./text\";\n\nexport class Line extends Text {\n    createField(): HTMLInputElement {\n        return document.createElement('input')\n    }\n}\n","import {Editable} from \"./editable\";\n\nexport abstract class Text extends Editable {\n    get value(): string {\n        return this.elem.textContent\n    }\n\n    bindEvents() {\n        this.elem.addEventListener('click', (e) => {\n            e.stopPropagation()\n            e.preventDefault()\n            e.cancelBubble = true\n\n            if (!this.editor.editionStarted(this.elem, this.elem.innerText)) {\n                return false\n            }\n\n            const input = this.createField()\n            input.value = this.elem.innerText\n\n            input.addEventListener('blur', () => {\n                const oldValue = this.elem.innerText\n                const newValue = input.value\n\n                this.elem.innerText = newValue\n                this.changed = true\n                input.parentNode.replaceChild(this.elem, input)\n\n                // Make sure that no one triggers a new click on an editable while this is running\n                setTimeout(() => this.editor.editionEnded(this.elem, oldValue, newValue), 100)\n            })\n\n            input.addEventListener('click', (e) => {\n                e.stopPropagation()\n                e.preventDefault()\n            })\n\n            let resize = () => {\n                input.style.height = 'auto'\n                input.style.height = `${input.scrollHeight}px`\n            }\n\n            // Workaround for cut, paste, drop and keydown\n            let delayedResize = () => window.setTimeout(resize, 0)\n\n            input.addEventListener('change', resize)\n            input.addEventListener('cut', delayedResize)\n            input.addEventListener('paste', delayedResize)\n            input.addEventListener('drop', delayedResize)\n            input.addEventListener('keydown', delayedResize)\n\n            input.style.width = 'auto'\n            input.style.height = `${this.elem.offsetHeight}px`\n            input.style.overflowY = \"hidden\"\n            input.style.fontSize = window.getComputedStyle(this.elem).fontSize\n\n            this.elem.parentNode.replaceChild(input, this.elem)\n            input.focus()\n            resize()\n        }, true)\n    }\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvZWRpdG9yLnRzIiwic3JjL2VsZW1lbnRzL2JnLWVkaXRhYmxlLnRzIiwic3JjL2VsZW1lbnRzL2Jsb2NrLnRzIiwic3JjL2VsZW1lbnRzL2VkaXRhYmxlLnRzIiwic3JjL2VsZW1lbnRzL2ZpbGUtdXBsb2FkLnRzIiwic3JjL2VsZW1lbnRzL2ltYWdlLnRzIiwic3JjL2VsZW1lbnRzL2xpbmUudHMiLCJzcmMvZWxlbWVudHMvdGV4dC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUEsMENBQXNDO0FBQ3RDLHdDQUFvQztBQUNwQywwQ0FBc0M7QUFFdEMsc0RBQWtEO0FBUWxEO0lBTUksZ0JBQW9CLE9BQWdCO1FBQWhCLFlBQU8sR0FBUCxPQUFPLENBQVM7UUFINUIsYUFBUSxHQUFXLFdBQVcsQ0FBQTtRQUM5QixlQUFVLEdBQVcsY0FBYyxDQUFBO1FBR3ZDLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQTtRQUVwQixJQUFJLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQTtRQUVmLElBQUksS0FBSyxHQUFtQixLQUFLLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQTtRQUNoRixLQUFLLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFBO1FBRTVFLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDO1lBQ3BDLElBQUksR0FBRyxTQUFVLENBQUE7WUFDakIsSUFBSSxXQUFXLEdBQTZCLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUVyRCxFQUFFLENB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ZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImltcG9ydCB7QmxvY2t9IGZyb20gJy4vZWxlbWVudHMvYmxvY2snXG5pbXBvcnQge0xpbmV9IGZyb20gJy4vZWxlbWVudHMvbGluZSdcbmltcG9ydCB7SW1hZ2V9IGZyb20gJy4vZWxlbWVudHMvaW1hZ2UnXG5pbXBvcnQge0VkaXRhYmxlfSBmcm9tICcuL2VsZW1lbnRzL2VkaXRhYmxlJ1xuaW1wb3J0IHtCZ0VkaXRhYmxlfSBmcm9tIFwiLi9lbGVtZW50cy9iZy1lZGl0YWJsZVwiO1xuXG5leHBvcnQgdHlwZSBPcHRpb25zID0ge1xuICAgIHNhdmVCdXR0b246IGJvb2xlYW4sXG4gICAgc2VsZWN0b3I6IHN0cmluZyxcbiAgICBiZ1NlbGVjdG9yOiBzdHJpbmcsXG59XG5cbmV4cG9ydCBjbGFzcyBFZGl0b3Ige1xuICAgIHByaXZhdGUgZWRpdGluZzogYm9vbGVhblxuICAgIHByaXZhdGUgZWxlbXM6IEVkaXRhYmxlW11cbiAgICBwcml2YXRlIHNlbGVjdG9yOiBzdHJpbmcgPSAnLmVkaXRhYmxlJ1xuICAgIHByaXZhdGUgYmdTZWxlY3Rvcjogc3RyaW5nID0gJy5iZy1lZGl0YWJsZSdcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgb3B0aW9uczogT3B0aW9ucykge1xuICAgICAgICB0aGlzLmhhbmRsZU9wdGlvbnMoKVxuXG4gICAgICAgIHRoaXMuZWxlbXMgPSBbXVxuXG4gICAgICAgIGxldCBlbGVtczogQXJyYXk8RWxlbWVudD4gPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5zZWxlY3RvcikpXG4gICAgICAgIGVsZW1zID0gZWxlbXMuY29uY2F0KEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLmJnU2VsZWN0b3IpKSlcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVsZW1zLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBsZXQgZWxtOiBFZGl0YWJsZVxuICAgICAgICAgICAgbGV0IGh0bWxFbGVtZW50OiBIVE1MRWxlbWVudCA9IDxIVE1MRWxlbWVudD5lbGVtc1tpXTtcblxuICAgICAgICAgICAgaWYgKGh0bWxFbGVtZW50Lm1hdGNoZXModGhpcy5iZ1NlbGVjdG9yKSkge1xuICAgICAgICAgICAgICAgIGVsbSA9IG5ldyBCZ0VkaXRhYmxlKGh0bWxFbGVtZW50LCB0aGlzKVxuICAgICAgICAgICAgfSBlbHNlIGlmIChlbGVtc1tpXS50YWdOYW1lID09PSAnUCcpIHtcbiAgICAgICAgICAgICAgICBlbG0gPSBuZXcgQmxvY2soaHRtbEVsZW1lbnQsIHRoaXMpXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGVsZW1zW2ldLnRhZ05hbWUgPT09ICdJTUcnKSB7XG4gICAgICAgICAgICAgICAgZWxtID0gbmV3IEltYWdlKGh0bWxFbGVtZW50LCB0aGlzKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbG0gPSBuZXcgTGluZShodG1sRWxlbWVudCwgdGhpcylcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZWxtLmJpbmRFdmVudHMoKVxuICAgICAgICAgICAgdGhpcy5lbGVtcy5wdXNoKGVsbSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGhhbmRsZU9wdGlvbnMoKSB7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2F2ZUJ1dHRvbiA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVTYXZlQnV0dG9uKClcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2VsZWN0b3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RvciA9IHRoaXMub3B0aW9ucy5zZWxlY3RvclxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZWRpdGlvblN0YXJ0ZWQoZWxlbTogSFRNTEVsZW1lbnQsIG9sZFZhbHVlOiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKHRoaXMuZWRpdGluZykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVkaXRpbmcgPSB0cnVlXG5cbiAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdzdGF0aWNfZWRpdC5lZGl0aW5nJywge2RldGFpbDoge2VsZW0sIG9sZFZhbHVlfX0pKVxuXG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuXG4gICAgZWRpdGlvbkVuZGVkKGVsZW06IEhUTUxFbGVtZW50LCBvbGRWYWx1ZTogc3RyaW5nLCBuZXdWYWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuZWRpdGluZyA9IGZhbHNlXG5cbiAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdzdGF0aWNfZWRpdC5lZGl0ZWQnLCB7ZGV0YWlsOiB7ZWxlbSwgb2xkVmFsdWUsIG5ld1ZhbHVlfX0pKVxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlU2F2ZUJ1dHRvbigpIHtcbiAgICAgICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcbiAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKVxuXG4gICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChcbiAgICAgICAgICAgICAgICBuZXcgQ3VzdG9tRXZlbnQoJ3N0YXRpY19lZGl0LnNhdmluZycsIHtkZXRhaWw6IHtjaGFuZ2VkOiB0aGlzLmVsZW1zLmZpbHRlcigoZSkgPT4gZS5oYXNDaGFuZ2VkKX19KVxuICAgICAgICAgICAgKVxuICAgICAgICB9KVxuXG4gICAgICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9ICdTYXZlJ1xuICAgICAgICBidXR0b24uc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnXG4gICAgICAgIGJ1dHRvbi5zdHlsZS50b3AgPSAnMjBweCdcbiAgICAgICAgYnV0dG9uLnN0eWxlLmxlZnQgPSAnMjBweCdcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChidXR0b24pXG4gICAgfVxufVxuIiwiaW1wb3J0IHtGaWxlVXBsb2FkfSBmcm9tIFwiLi9maWxlLXVwbG9hZFwiO1xuXG5leHBvcnQgY2xhc3MgQmdFZGl0YWJsZSBleHRlbmRzIEZpbGVVcGxvYWQge1xuXG4gICAgZ2V0IHZhbHVlKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW0uc3R5bGUuYmFja2dyb3VuZEltYWdlXG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGNoYW5nZVZhbHVlKHZhbHVlLCBuYW1lKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZWxlbS5kYXRhc2V0LmZpbGVOYW1lID0gbmFtZVxuICAgICAgICB0aGlzLmVsZW0uc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgke3ZhbHVlfSlgXG4gICAgfVxufSIsImltcG9ydCB7VGV4dH0gZnJvbSBcIi4vdGV4dFwiO1xuXG5leHBvcnQgY2xhc3MgQmxvY2sgZXh0ZW5kcyBUZXh0IHtcbiAgICBjcmVhdGVGaWVsZCgpOiBIVE1MSW5wdXRFbGVtZW50IHtcbiAgICAgICAgcmV0dXJuIDxhbnk+ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGV4dGFyZWEnKVxuICAgIH1cbn1cbiIsImltcG9ydCB7RWRpdG9yfSBmcm9tICcuLi9lZGl0b3InXG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBFZGl0YWJsZSB7XG4gICAgcHJvdGVjdGVkIGVsZW06IEhUTUxFbGVtZW50XG4gICAgcHJvdGVjdGVkIGVkaXRvcjogRWRpdG9yXG4gICAgcHJvdGVjdGVkIGNoYW5nZWQ6IGJvb2xlYW5cblxuICAgIGNvbnN0cnVjdG9yKGVsZW06IEhUTUxFbGVtZW50LCBlZGl0b3I6IEVkaXRvcikge1xuICAgICAgICB0aGlzLmVsZW0gPSBlbGVtXG4gICAgICAgIHRoaXMuZWRpdG9yID0gZWRpdG9yXG4gICAgfVxuXG4gICAgZ2V0IGVsZW1lbnQoKTogSFRNTEVsZW1lbnQge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtXG4gICAgfVxuXG4gICAgZ2V0IGhhc0NoYW5nZWQoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoYW5nZWRcbiAgICB9XG5cbiAgICBhYnN0cmFjdCBnZXQgdmFsdWUoKTogc3RyaW5nXG5cbiAgICBhYnN0cmFjdCBjcmVhdGVGaWVsZCgpOiBIVE1MSW5wdXRFbGVtZW50XG5cbiAgICBhYnN0cmFjdCBiaW5kRXZlbnRzKCk6IHZvaWRcbn1cbiIsImltcG9ydCB7RWRpdGFibGV9IGZyb20gXCIuL2VkaXRhYmxlXCJcblxuaW50ZXJmYWNlIEZpbGVSZWFkZXJFdmVudFRhcmdldCBleHRlbmRzIEV2ZW50VGFyZ2V0IHtcbiAgICByZXN1bHQ6IHN0cmluZ1xufVxuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgRmlsZVVwbG9hZCBleHRlbmRzIEVkaXRhYmxlIHtcbiAgICBjcmVhdGVGaWVsZCgpOiBIVE1MSW5wdXRFbGVtZW50IHtcbiAgICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG5cbiAgICAgICAgaW5wdXQudHlwZSA9ICdmaWxlJ1xuICAgICAgICBpbnB1dC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXG5cbiAgICAgICAgcmV0dXJuIGlucHV0XG4gICAgfVxuXG4gICAgYmluZEV2ZW50cygpIHtcbiAgICAgICAgdGhpcy5lbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuXG4gICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5jcmVhdGVGaWVsZCgpXG4gICAgICAgICAgICBmaWxlLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB1cGxvYWRlZEZpbGUgPSBmaWxlLmZpbGVzWzBdXG4gICAgICAgICAgICAgICAgaWYgKCEhdXBsb2FkZWRGaWxlLnR5cGUubWF0Y2goL2ltYWdlLiovKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXG4gICAgICAgICAgICAgICAgICAgIHJlYWRlci5hZGRFdmVudExpc3RlbmVyKCdsb2FkZW5kJywgKGU6IFByb2dyZXNzRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gKDxGaWxlUmVhZGVyRXZlbnRUYXJnZXQ+ZS50YXJnZXQpLnJlc3VsdFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSB0aGlzLnZhbHVlXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlVmFsdWUobmV3VmFsdWUsIHVwbG9hZGVkRmlsZS5uYW1lKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VkID0gdHJ1ZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmaWxlKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuZWRpdG9yLmVkaXRpb25FbmRlZCh0aGlzLmVsZW0sIG9sZFZhbHVlLCBuZXdWYWx1ZSksIDEwMClcbiAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTCh1cGxvYWRlZEZpbGUpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgdGhpcy5lbGVtLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQoZmlsZSlcbiAgICAgICAgICAgIGZpbGUuY2xpY2soKVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBhYnN0cmFjdCBjaGFuZ2VWYWx1ZSh2YWx1ZSwgbmFtZSk6IHZvaWRcbn1cbiIsImltcG9ydCB7RmlsZVVwbG9hZH0gZnJvbSBcIi4vZmlsZS11cGxvYWRcIjtcblxuZXhwb3J0IGNsYXNzIEltYWdlIGV4dGVuZHMgRmlsZVVwbG9hZCB7XG4gICAgZWxlbTogSFRNTEltYWdlRWxlbWVudFxuXG4gICAgZ2V0IHZhbHVlKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW0uc3JjXG4gICAgfVxuXG4gICAgY2hhbmdlVmFsdWUodmFsdWUsIG5hbWUpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5lbGVtLnNyYyA9IHZhbHVlXG4gICAgICAgIHRoaXMuZWxlbS5kYXRhc2V0LmZpbGVOYW1lID0gbmFtZVxuICAgIH1cbn1cbiIsImltcG9ydCB7VGV4dH0gZnJvbSBcIi4vdGV4dFwiO1xuXG5leHBvcnQgY2xhc3MgTGluZSBleHRlbmRzIFRleHQge1xuICAgIGNyZWF0ZUZpZWxkKCk6IEhUTUxJbnB1dEVsZW1lbnQge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKVxuICAgIH1cbn1cbiIsImltcG9ydCB7RWRpdGFibGV9IGZyb20gXCIuL2VkaXRhYmxlXCI7XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBUZXh0IGV4dGVuZHMgRWRpdGFibGUge1xuICAgIGdldCB2YWx1ZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtLnRleHRDb250ZW50XG4gICAgfVxuXG4gICAgYmluZEV2ZW50cygpIHtcbiAgICAgICAgdGhpcy5lbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgICAgICAgICAgZS5jYW5jZWxCdWJibGUgPSB0cnVlXG5cbiAgICAgICAgICAgIGlmICghdGhpcy5lZGl0b3IuZWRpdGlvblN0YXJ0ZWQodGhpcy5lbGVtLCB0aGlzLmVsZW0uaW5uZXJUZXh0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9IHRoaXMuY3JlYXRlRmllbGQoKVxuICAgICAgICAgICAgaW5wdXQudmFsdWUgPSB0aGlzLmVsZW0uaW5uZXJUZXh0XG5cbiAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSB0aGlzLmVsZW0uaW5uZXJUZXh0XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBpbnB1dC52YWx1ZVxuXG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtLmlubmVyVGV4dCA9IG5ld1ZhbHVlXG4gICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VkID0gdHJ1ZVxuICAgICAgICAgICAgICAgIGlucHV0LnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKHRoaXMuZWxlbSwgaW5wdXQpXG5cbiAgICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhhdCBubyBvbmUgdHJpZ2dlcnMgYSBuZXcgY2xpY2sgb24gYW4gZWRpdGFibGUgd2hpbGUgdGhpcyBpcyBydW5uaW5nXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLmVkaXRvci5lZGl0aW9uRW5kZWQodGhpcy5lbGVtLCBvbGRWYWx1ZSwgbmV3VmFsdWUpLCAxMDApXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgbGV0IHJlc2l6ZSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBpbnB1dC5zdHlsZS5oZWlnaHQgPSAnYXV0bydcbiAgICAgICAgICAgICAgICBpbnB1dC5zdHlsZS5oZWlnaHQgPSBgJHtpbnB1dC5zY3JvbGxIZWlnaHR9cHhgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFdvcmthcm91bmQgZm9yIGN1dCwgcGFzdGUsIGRyb3AgYW5kIGtleWRvd25cbiAgICAgICAgICAgIGxldCBkZWxheWVkUmVzaXplID0gKCkgPT4gd2luZG93LnNldFRpbWVvdXQocmVzaXplLCAwKVxuXG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCByZXNpemUpXG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjdXQnLCBkZWxheWVkUmVzaXplKVxuICAgICAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigncGFzdGUnLCBkZWxheWVkUmVzaXplKVxuICAgICAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIGRlbGF5ZWRSZXNpemUpXG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZGVsYXllZFJlc2l6ZSlcblxuICAgICAgICAgICAgaW5wdXQuc3R5bGUud2lkdGggPSAnYXV0bydcbiAgICAgICAgICAgIGlucHV0LnN0eWxlLmhlaWdodCA9IGAke3RoaXMuZWxlbS5vZmZzZXRIZWlnaHR9cHhgXG4gICAgICAgICAgICBpbnB1dC5zdHlsZS5vdmVyZmxvd1kgPSBcImhpZGRlblwiXG4gICAgICAgICAgICBpbnB1dC5zdHlsZS5mb250U2l6ZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMuZWxlbSkuZm9udFNpemVcblxuICAgICAgICAgICAgdGhpcy5lbGVtLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKGlucHV0LCB0aGlzLmVsZW0pXG4gICAgICAgICAgICBpbnB1dC5mb2N1cygpXG4gICAgICAgICAgICByZXNpemUoKVxuICAgICAgICB9LCB0cnVlKVxuICAgIH1cbn0iXX0="}